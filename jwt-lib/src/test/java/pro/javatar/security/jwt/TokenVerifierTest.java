package pro.javatar.security.jwt;

import org.junit.jupiter.api.Test;

import static org.hamcrest.CoreMatchers.is;
import static org.hamcrest.CoreMatchers.nullValue;
import static org.hamcrest.MatcherAssert.assertThat;

class TokenVerifierTest {

    @Test
    void getRealm() {
        String tokenString =
                "eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJKY3VFRElBUXhHYld1NVdpNlg1Y3kzOFpBcXhRV25RYXJIMW1wZGFpTXM4In0.eyJqdGkiOiJjN2MwZTE1Yi1jZDFkLTQ1OGEtYjQ2Yy1kZGRmNmZiNWYxNmUiLCJleHAiOjE0OTYyMjY4NjIsIm5iZiI6MCwiaWF0IjoxNDk2MjI2NTYyLCJpc3MiOiJodHRwOi8vbG9naW4uc2VjOjgwODIvYXV0aC9yZWFsbXMvbXNlcnZpY2UiLCJhdWQiOiJvdGEiLCJzdWIiOiI4YzkxYzBhYy0yYjNmLTRkMTEtOTc0OC0wOTZjMzk1YmM5NzMiLCJ0eXAiOiJCZWFyZXIiLCJhenAiOiJvdGEiLCJhdXRoX3RpbWUiOjAsInNlc3Npb25fc3RhdGUiOiIzZWUwZjY0My00MDRmLTQ5NmUtYTE3My1kMDU4YmEwNzA0MTgiLCJhY3IiOiIxIiwiY2xpZW50X3Nlc3Npb24iOiI3NDQ1YzRjNy04OTA5LTRmODAtYjJiZS03OWFjYTgxYmZkYzYiLCJhbGxvd2VkLW9yaWdpbnMiOltdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsiT1RBXzJTRVJWSUNFIiwiT1RBX1NFUlZJQ0UiLCJ1bWFfYXV0aG9yaXphdGlvbiJdfSwicmVzb3VyY2VfYWNjZXNzIjp7Im90YSI6eyJyb2xlcyI6WyJPVEFfMlNFUlZJQ0UiLCJPVEFfU0VSVklDRSJdfSwiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwibmFtZSI6Ikdlb3JneSBGaXNoZXJtYW4iLCJwcmVmZXJyZWRfdXNlcm5hbWUiOiJhZG1pbiIsImdpdmVuX25hbWUiOiJHZW9yZ3kiLCJmYW1pbHlfbmFtZSI6IkZpc2hlcm1hbiIsImVtYWlsIjoidGVzdDExQHRlc3QuY29tIn0.jMsCS7MMLX2rwpBbNG_QFHaxus2xrpRapygYtoA34k4ybwT_DUKBlAmCb9hCzqH82QRLbQ3Ib12guQ3hfpikRvYxAo9AxNDrA4id97UcW0U6iAmSYGdoOzrIaw363N_r-TvKSkDFK-L_bF62GzlvB-Y91bhBSokMv-I-VmVMv0Do5KQkIEwDMyUf4w4vC6Vf2A7g_sK3SVk8LajtMGfI_OVly3eCffNPHBXujE1evgivh2CMsL3J4J9Aczqdw4KD-4-HfwFBX_NHXH1YFpFukR6RB2iNsHdTlk_-ke3I5ti0mGmxMWsPb9Gjg1zhr6qwAq7A2MKGKGi9beMAO1RHKg";
        assertThat(TokenVerifier.getRealm(tokenString), is("mservice"));

        tokenString =
                "eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJ6eHBEZEluUi0xdWhvczl2UzV0TjZONWVHNzFaR2pkdWx5am84UUhXRGc0In0.eyJqdGkiOiJkMjEyOGNkMS1mOTdiLTRmYTctOWI3Yi1iM2YxNWFkZmE4MjkiLCJleHAiOjE0OTUxNDYwMjUsIm5iZiI6MCwiaWF0IjoxNDk1MTQ1NzI1LCJpc3MiOiJodHRwOi8vbG9naW4uc2VjOjgwODIvYXV0aC9yZWFsbXMvdGVzdC1mbHlnbGluamVuIiwiYXVkIjoic21zNCIsInN1YiI6Ijg0NmYwYzgyLWMxODQtNDdmZi05YjUyLWE2MjJjYWJiOGMwMiIsInR5cCI6IkJlYXJlciIsImF6cCI6InNtczQiLCJhdXRoX3RpbWUiOjAsInNlc3Npb25fc3RhdGUiOiJiZDRlMDZmYi0xNGE2LTQ0NmMtYWM5NS1kNWY1MDJhNWRlNWIiLCJhY3IiOiIxIiwiY2xpZW50X3Nlc3Npb24iOiJhY2M1M2RhYi03YmY1LTQ3ODItYmIwOS1jMTM5YTU2ZjA1NWUiLCJhbGxvd2VkLW9yaWdpbnMiOlsiaHR0cDovL2xvY2FsaG9zdDo4MDgxLyoiLCJodHRwczovL3Ntcy5zZWM6ODQ0MyIsImh0dHA6Ly9sb2NhbGhvc3Q6ODA4MC90ZXN0Il0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJTRUFUX01BVENISU5HX0FMTCIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19LCJzbXM0Ijp7InJvbGVzIjpbIlNFQVRfTUFUQ0hJTkciXX19LCJuYW1lIjoiVmFsZXJpeSBUYXJhcHVua2EiLCJwcmVmZXJyZWRfdXNlcm5hbWUiOiJhZG1pbiIsImdpdmVuX25hbWUiOiJWYWxlcml5IiwiZmFtaWx5X25hbWUiOiJUYXJhcHVua2EiLCJlbWFpbCI6ImFkbWluQHRlc3QuY29tIn0.YRDyKM0LQOY29GQKWPbJ5-zViz1z_TJYD_8RwzJkidzLjahdJ1t0fvfhedpGY0sG_xXChwjsBWqPbJYPbnQC2abtg6eer6DkTwEUWKiYwxgrvpWLCdswOc74X9hrD3pXFyg92jQ1oU493U2iKRHH4nSm0Sfz2-CxpQ6i9dwcbRuSID3uYUAEYvA9NPkZ9TGUyScb8J6BLyJdp21vY5mqLyzMizLry4PqEWyBm4vjmgZbHIwEziYEGDJyCfiPW7mxPY-ZrL5oAQv8XHDvRO-nD8JYAhzz-jXIi7MvRLC8nCMtSggP3TiicFnBXGuyTHNtkkcw01E6G9NlffUrjcGueA";
        assertThat(TokenVerifier.getRealm(tokenString), is("test-flyglinjen"));

        assertThat(TokenVerifier.getRealm(""), is(nullValue()));
        assertThat(TokenVerifier.getRealm(null), is(nullValue()));
    }
}